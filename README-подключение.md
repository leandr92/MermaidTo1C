# Как подключить Mermaid в свои HTML файлы

## Минимальный набор (обязательно)

Для работы Mermaid в старых браузерах (WebKit 1С) **критически важно** включить:

### 1. Полифиллы (ДО загрузки mermaid)

Три полифилла должны быть загружены **до** подключения основного скрипта:

- `Object.hasOwn` (ES2022)
- `Array.prototype.at()` (ES2022) 
- `SVGElement.getBBox()` (для старых браузеров)

### 2. Подключение скрипта

```html
<script src="dist/mermaid_all_in_one_v11.12.2.js"></script>
```

### 3. Диаграммы

Используйте элементы с классом `.mermaid`:

```html
<pre class="mermaid">flowchart-elk TD
A[Начало] --> B[Конец]</pre>
```

## Полный минимальный пример

См. файл `example-minimal.html` - это минимально необходимый код.

## Что можно убрать из текущего файла

Из файла `Просмотр Mermaid схем all in one.html` можно безопасно убрать:

### ❌ Можно убрать (не обязательно):

1. **Весь отладочный код** (строки 275-451):
   - Функция `analyzeSVGElements()`
   - Все `console.log` с префиксом `HTML DEBUG:`
   - Проверки конфигурации после загрузки
   - Это было нужно только для диагностики проблемы с ELK

2. **Стили** (строки 7-111):
   - Опциональны, но рекомендуется оставить базовые стили для красивого отображения
   - Можно оставить только минимальные стили

3. **Явный вызов `mermaid.run()`**:
   - Не обязателен, т.к. Mermaid инициализирован с `startOnLoad: true`
   - Но можно оставить для надежности

### ✅ Обязательно оставить:

1. **Полифиллы** (строки 141-269) - критически важны!
2. **Подключение скрипта** (строка 273)
3. **Элементы с классом `.mermaid`** с вашими диаграммами

## Рекомендуемая структура для ваших файлов

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Ваша страница</title>
    <!-- Опционально: базовые стили -->
    <style>
        .mermaid { font-family: sans-serif; }
    </style>
</head>
<body>
    <!-- Ваши диаграммы -->
    <pre class="mermaid">flowchart-elk TD
    A --> B
    </pre>

    <!-- ОБЯЗАТЕЛЬНО: Полифиллы ДО mermaid -->
    <script>
        // Полифиллы (см. example-minimal.html)
    </script>
    
    <!-- ОБЯЗАТЕЛЬНО: Подключение Mermaid -->
    <script src="dist/mermaid_all_in_one_v11.12.2.js"></script>
</body>
</html>
```

## Использование угловатых линий (ELK)

Для диаграмм с угловатыми линиями используйте:

- `flowchart-elk TD` вместо `graph TD`
- Или `flowchart-elk LR` вместо `graph LR`

ELK уже настроен по умолчанию в конфигурации, но явное указание `flowchart-elk` гарантирует использование угловатых линий.

## Примеры файлов

- `example-minimal.html` - минимальный пример без стилей
- `example-with-styles.html` - пример с базовыми стилями
- `Просмотр Mermaid схем all in one.html` - полный пример с отладкой (можно использовать как шаблон, убрав отладочный код)

